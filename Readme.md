# Получение последних новостей с [mosmetro.ru/news ]()

# Задача:

Написать API, которое получает новости за заданный период из базы
и парсер который каждые 10 минут парсит новости
с сайта https://mosmetro.ru/news
и сохраняет в базу с меткой когда эти новости спаршены, 

пример метода
/metro/news?day=5

в качестве ответа вернуть JSON новости которые опубликованы за последний 5 дней (включительно) 
заголовок 
url картинки
дата публикации (YYYY-mm-dd)

# Запуск
`docker compose up --build`

# data_loader

Здесь скрипты для парсинга новостей с сайта и загрузки в базу.
Сделал немного абстракций на случай если понадобится еще откуда-то грузить данные.
Дату вместо даты парсинга я достал из html и преобразовал в datetime

Периодический запуск скриптов происходит с помощью `Celery`.  

### Сделать бы еще:
- Возможно стоит сделать абстракцию для парсинга, хотя текущая
реализация позволяет подключать кастомные парсеры
- Попытаться объединить celery worker и beat в один инстанс,
не получилось сделать это сразу
- Проверить не будет ли ошибок из-за timezone

# news_api

Приложение на `flask`, открывающая ручку для поулчения новостей
с фильтрацией по количеству дней, смещению и лимиту.

### Сделать бы еще:
- Валидация входящих параметров, например, чтоб limit не
был выше определенного значения
- Перенести код ручки в отдельный файл
- Кажется оверхедом как сейчас происходит сбор и возврат результата из базы,
стоит посмотреть в сторону [FlaskPydanticSpec](https://github.com/turner-townsend/flask-pydantic-spec)
- Сделать сервис получения новостей классом
- Работу с базой сделать абстрактной, для подключение других бд

# Почему `MongoDB`:
- Нет необходимости в связях с другими таблицами
- Легкое горизонтальное мастштабирование